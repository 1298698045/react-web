(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[96],{A7lj:function(e,t,n){e.exports={checkboxGroup:"antd-pro-pages-student-archive-archive-checkboxGroup"}},UL0h:function(e,t,n){"use strict";n.r(t);n("y8nQ");var a=n("Vl3Y"),i=n("eHn4"),r=n.n(i),o=(n("+L6B"),n("2/Rp")),c=(n("2qtc"),n("kLXV")),l=n("jehZ"),u=n.n(l),s=(n("5Dmo"),n("3S7+")),d=n("p0pE"),f=n.n(d),m=n("qIgq"),E=n.n(m),b=n("q1tI"),v=n.n(b),p=n("MuoO"),h=n("uY7g"),y=n("zHco"),T=n("Y2fQ"),S=n("myFP"),k=n("9vKQ"),A=n("mGJS"),g=n("A7lj"),D=n.n(g),N=function(e){var t=e.selectedRows,n=e.onSubmit,i=e.visible,o=e.setVisible,l=e.form,s=e.loading,d=function(e){e.preventDefault(),l.validateFields(function(e,a){if(e)return!1;n(f()({},a,r()({studentIds:t.map(function(e){return e.id}).join(",")},k["a"].STUDENT.ARCHIVE_DELAY_REASON.key,a[k["a"].STUDENT.ARCHIVE_DELAY_REASON.key].join(","))))})},m=function(e){e.preventDefault(),o(!1)};return v.a.createElement(c["a"],{destroyOnClose:!0,title:"\u6682\u7f13\u5efa\u6863 - "+t.map(function(e){return e[k["a"].STUDENT.NAME.key]}).join("\u3001"),width:360,visible:i,onOk:d,onCancel:m,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:s,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},v.a.createElement(a["a"],{onSubmit:d,className:D.a.checkboxGroup},v.a.createElement(A["a"],u()({className:"zh-customer-checkbox"},e,{config:k["a"].STUDENT.ARCHIVE_DELAY_REASON,form:l,rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b"}]}))))},O=a["a"].create()(N),R=function(e){var t=e.selectedRows,n=e.onSubmit,i=e.visible,r=e.setVisible,o=e.form,l=e.loading,s=function(e){e.preventDefault(),o.validateFields(function(e,a){if(e)return!1;n(f()({},a,{studentIds:t.map(function(e){return e.id}).join(",")}))})},d=function(e){e.preventDefault(),r(!1)};return v.a.createElement(c["a"],{destroyOnClose:!0,title:"\u7ec8\u6b62\u5efa\u6863 - "+t.map(function(e){return e[k["a"].STUDENT.NAME.key]}).join("\u3001"),width:360,visible:i,onOk:s,onCancel:d,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:l,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88"},v.a.createElement(a["a"],{onSubmit:s},v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.ARCHIVE_STOP_REASON,form:o,rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b"}]})),v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.ARCHIVE_STOP_MEMO,form:o}))))},_=a["a"].create()(R),C=function(e){var t=e.selectedRows,n=e.onSubmit,i=e.visible,o=e.setVisible,l=e.form,s=e.loading,d=function(e){e.preventDefault(),l.validateFields(function(e,a){if(e)return!1;n(f()({},a,r()({studentIds:t.map(function(e){return e.id}).join(",")},k["a"].STUDENT.ARCHIVE_FINISH_DATE.key,a[k["a"].STUDENT.ARCHIVE_FINISH_DATE.key].format("YYYY-MM-DD"))))})},m=function(e){e.preventDefault(),o(!1)};return v.a.createElement(c["a"],{destroyOnClose:!0,title:"\u5b8c\u6210\u5efa\u6863 - "+t.map(function(e){return e[k["a"].STUDENT.NAME.key]}).join("\u3001"),width:360,visible:i,onOk:d,onCancel:m,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:s,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88"},v.a.createElement(a["a"],{onSubmit:d},v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.ARCHIVE_FINISH_OPERATOR,form:l,rules:[{required:!0,message:"\u8be5\u9009\u9879\u4e3a\u5fc5\u586b"}],useDefault:!0})),v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.ARCHIVE_FINISH_DATE,form:l,rules:[{required:!0,message:"\u8be5\u9009\u9879\u4e3a\u5fc5\u586b"}],initialValue:Date.now()}))))},I=a["a"].create()(C),U=function(e){var t=e.selectedRows,n=e.onSubmit,i=e.visible,r=e.setVisible,o=e.form,l=e.loading,s=function(e){e.preventDefault(),o.validateFields(function(e,a){if(e)return!1;n(f()({},a,{studentId:t[0].id}))})},d=function(e){e.preventDefault(),r(!1)};return v.a.createElement(c["a"],{destroyOnClose:!0,title:"\u5907\u6ce8\u4fe1\u606f - "+t.map(function(e){return e[k["a"].STUDENT.NAME.key]}).join("\u3001"),width:360,visible:i,onOk:s,onCancel:d,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:l,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},v.a.createElement(a["a"],{onSubmit:s},v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.MEMO,form:o,rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b"}]}))))},V=a["a"].create()(U),j=function(e){var t=e.selectedRow,n=e.onSubmit,i=e.visible,r=e.setVisible,o=e.form,l=e.loading,s=function(e){e.preventDefault(),o.validateFields(function(e,a){if(e)return!1;n(f()({},a,{id:t.id}))})},d=function(e){e.preventDefault(),r(!1)};return v.a.createElement(c["a"],{destroyOnClose:!0,title:"\u4fee\u6539\u6863\u6848\u7f16\u53f7 - "+t[k["a"].STUDENT.NAME.key],width:360,visible:i,onOk:s,onCancel:d,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:l,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88"},v.a.createElement(a["a"],{onSubmit:s},v.a.createElement(A["a"],u()({},e,{config:k["a"].STUDENT.ARCHIVE_ID,form:o,initialValue:t[k["a"].STUDENT.ARCHIVE_ID.key],rules:[{required:!0,message:"\u8be5\u9879\u4e3a\u5fc5\u586b"}]}))))},w=a["a"].create()(j),M=n("E/UG"),H=n("rdXg"),x=n.n(H),L=function(e,t){var n=new Blob([t]);if("download"in document.createElement("a")){var a=document.createElement("a");a.download=e,a.style.display="none",a.href=URL.createObjectURL(n),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}else navigator.msSaveBlob(n,e)},P=n("03Mi"),F=n("Zcyb"),q="studentArchive",Y=function(e){var t=Object(b["useState"])([]),n=E()(t,2),a=n[0],i=n[1],r=e.dispatch,l=e.form,d=e.dictionary,m=e.loading,p=e.quickEntryParams,g=Object(b["useState"])(!1),D=E()(g,2),N=D[0],R=D[1],C=Object(b["useState"])(!1),U=E()(C,2),j=U[0],H=U[1],Y=Object(b["useState"])(!1),K=E()(Y,2),B=K[0],G=K[1],J=Object(b["useState"])(!1),Q=E()(J,2),z=Q[0],X=Q[1],Z=Object(b["useState"])(!1),W=E()(Z,2),$=W[0],ee=W[1],te=Object(b["useState"])({}),ne=E()(te,2),ae=ne[0],ie=ne[1],re=Object(b["useState"])(!1),oe=E()(re,2),ce=oe[0],le=oe[1],ue=Object(b["useState"])(!1),se=E()(ue,2),de=se[0],fe=se[1],me=Object(b["useState"])(!1),Ee=E()(me,2),be=Ee[0],ve=Ee[1],pe=Object(b["useState"])({}),he=E()(pe,2),ye=he[0],Te=he[1],Se=Object(b["useState"])("-1"),ke=E()(Se,2),Ae=ke[0],ge=ke[1];Object(F["a"])(function(){p&&Te(p),ge(p.tabKey||"0"),r({type:"quickEntryParams/clearParams"})},[r]);var De=function(e){if(e)return e.map(function(e){return e.reason.split(",").map(function(t){return Object(P["c"])(d,{REPORT_STOP_DOCUMENT:"stop_reason",REPORT_DEFER_DOCUMENT:"delay_reason"}[e.action],t)}).join("\u3001")}).join("\n")},Ne=[f()({},k["a"].STUDENT.NAME,{customRender:function(e,t,n){return v.a.createElement(h["a"],{privs:["archivist_detail"],noMatch:e},v.a.createElement("a",{onClick:function(e){e.stopPropagation(),le(t.id),fe(!0)}},e))}}),k["a"].STUDENT.MOBILE,f()({},k["a"].STUDENT.MAJOR_CARD_CODE,{customRender:function(e,t,n){return t["baseInfo"][k["a"].STUDENT.MAJOR_CARD_CODE.key]}}),f()({},k["a"].STUDENT.ARCHIVE_ID,{customRender:function(e,t,n){return v.a.createElement(h["a"],{privs:["archivist_no_edit"],noMatch:e},v.a.createElement("a",{onClick:function(e){e.stopPropagation(),ie(t),ee(!0)}},e||"\u6dfb\u52a0"))}}),k["a"].STUDENT.DEPART_ID_SCHOOL,k["a"].STUDENT.LICENSE_TYPE,k["a"].STUDENT.STUDENT_TYPE,f()({},k["a"].STUDENT.ARCHIVE_STATUS,{customRender:function(e,t,n,a){return 1==e?a:v.a.createElement(s["a"],{title:"\u539f\u56e0\uff1a".concat(De(t.changeLogs)||"\u6682\u65e0")},v.a.createElement("a",null,a))}})],Oe=[{config:{key:"keywords",title:"\u5b66\u5458",type:"input",placeholder:"\u59d3\u540d/\u624b\u673a\u53f7/\u8eab\u4efd\u8bc1\u6a21\u7cca\u641c\u7d22"}},{config:k["a"].STUDENT.DEPART_ID_SCHOOL,initialValue:ye.departId||void 0},{config:k["a"].STUDENT.LICENSE_TYPE_ACTIVE,initialValue:ye.licenseType||void 0},{config:{key:"studentType",title:"\u5b66\u5458\u7c7b\u578b",type:"select"},values:[{dKey:"1",dValue:"\u672c\u6821"},{dKey:"4",dValue:"\u6302\u9760"}]},{config:k["a"].STUDENT.CLASS_ID},{config:{key:"studentStatus",title:"\u6863\u6848\u72b6\u6001",type:"select"},values:[{dKey:"1",dValue:"\u5f85\u5efa\u6863"},{dKey:"2",dValue:"\u6682\u7f13\u5efa\u6863"},{dKey:"3",dValue:"\u7ec8\u6b62\u5efa\u6863"}]},{config:k["a"].STUDENT.PAY_TIME}],Re=Object(b["useMemo"])(function(){return Oe.map(function(e){return v.a.createElement(A["a"],u()({},e,{initialValue:e.initialValue,form:l}))})},[l]),_e=function(e){if(0!==a.length){var t=a.map(function(e){return e.id}).join(",");switch(e.key){case"printArchiveBag":r({type:"studentArchive/".concat(e.key),payload:{id:t}}).then(function(e){!1!==e&&x()({printable:["data:image/jpeg;base64,"+e],type:"image",imageStyle:"width: 1500px; height: 1030px;"})});break;case"printHealthForm":r({type:"studentArchive/".concat(e.key),payload:{id:t}}).then(function(e){!1!==e&&x()("data:image/jpeg;base64,"+e,"image")});break;case"exportArchive":r({type:"studentArchive/exportArchive",payload:{ids:t}}).then(function(e){L("\u5efa\u6863\u5bfc\u51fa.xls",e)});break;case"delayArchive":R(!0);break;case"waitForArchive":c["a"].confirm({title:"\u8f6c\u4e3a\u5f85\u5efa\u6863",content:"\u4f60\u786e\u5b9a\u8981\u628a\u3010"+a.map(function(e){return e.name}).join("\u3011\uff0c\u3010")+"\u3011\u8f6c\u4e3a\u5f85\u5efa\u6863\u5417\uff1f",onOk:function(){return r({type:"studentArchive/waitForArchive",payload:{studentIds:t}}).then(function(e){!1!==e&&(ve(!0),i([]))})},onCancel:function(){}});break;case"stopArchive":H(!0);break;case"finishArchive":G(!0);break;case"remark":X(!0);break}}},Ce=[{privName:"archivist_print",key:"printArchiveBag",title:"\u6253\u5370\u6863\u6848\u888b",length:1,disable:function(e){return e.find(function(e){return 3==e.studentStatus})}},{privName:"physcial_print",key:"printHealthForm",title:"\u6253\u5370\u4f53\u68c0\u8868",length:1,disable:function(e){return e.find(function(e){return 3==e.studentStatus})}},{privName:"pause_document",key:"delayArchive",title:"\u6682\u7f13\u5efa\u6863",length:100,disable:function(e){return e.find(function(e){return 2==e.studentStatus||3==e.studentStatus})}},{privName:"wait_document",key:"waitForArchive",title:"\u5f85\u5efa\u6863",length:100,disable:function(e){return e.find(function(e){return 1==e.studentStatus||3==e.studentStatus})}},{privName:"break_document",key:"stopArchive",title:"\u7ec8\u6b62\u5efa\u6863",length:100,disable:function(e){return e.find(function(e){return 3==e.studentStatus})}},{privName:"complete_document",key:"finishArchive",title:"\u5b8c\u6210\u5efa\u6863",length:100,disable:function(e){return e.find(function(e){return 3==e.studentStatus})}},{privName:"export_document",key:"exportArchive",title:"\u5bfc\u51fa",length:100},{privName:"archivist_memo",key:"remark",title:"\u5907\u6ce8",length:1}].map(function(e){return v.a.createElement(h["a"],{key:e.key,privs:[e.privName]},v.a.createElement(o["a"],{type:"primary",key:e.key,disabled:!a.length||a.length>e.length||e.disable&&e.disable(a),onClick:function(){return _e({key:e.key})}},e.title))}),Ie=function(e){return r({type:"studentArchive/delayArchive",payload:e}).then(function(e){!1!==e&&(ve(!0),i([]))})},Ue=function(e){return r({type:"studentArchive/stopArchive",payload:e}).then(function(e){!1!==e&&(ve(!0),i([]))})},Ve=function(e){return r({type:"studentArchive/finishArchive",payload:e}).then(function(e){!1!==e&&(ve(!0),i([]))})},je=function(e){return r({type:"studentArchive/saveArchiveRemark",payload:e}).then(function(e){!1!==e&&(ve(!0),i([]))})},we=function(e){return r({type:"studentArchive/saveArchiveID",payload:e}).then(function(){ve(!0)})};return v.a.createElement(y["a"],{title:v.a.createElement(T["FormattedMessage"],{id:"menu.student.archive"})},"0"===Ae&&v.a.createElement(S["a"],u()({},e,{tableName:q,tableActions:Ce,selectedRows:a,setSelectedRows:i,originColumns:Ne,formFields:Re,columnSortable:!1,needUpdate:be,setNeedUpdate:ve,handleFormReset:function(){Te({}),ve(!0)}})),v.a.createElement(O,{selectedRows:a,visible:N,setVisible:R,loading:m.effects["studentArchive/delayArchive"],onSubmit:function(e){console.log(e),Ie(e).then(function(e){!1!==e&&R(!1)})}}),v.a.createElement(_,{selectedRows:a,visible:j,setVisible:H,loading:m.effects["studentArchive/stopArchive"],onSubmit:function(e){console.log(e),Ue(e).then(function(e){!1!==e&&H(!1)})}}),v.a.createElement(I,{selectedRows:a,visible:B,setVisible:G,loading:m.effects["studentArchive/finishArchive"],onSubmit:function(e){console.log(e),Ve(e).then(function(e){!1!==e&&G(!1)})}}),v.a.createElement(V,{selectedRows:a,visible:z,setVisible:X,loading:m.effects["studentArchive/saveArchiveRemark"],onSubmit:function(e){console.log(e),je(e).then(function(e){!1!==e&&X(!1)})}}),v.a.createElement(w,{selectedRow:ae,visible:$,setVisible:ee,loading:m.effects["studentArchive/saveArchiveID"],onSubmit:function(e){console.log(e),we(e).then(function(e){!1!==e&&ee(!1)})}}),v.a.createElement(M["a"],{studentId:ce,visible:de,setVisible:fe}))};t["default"]=Object(p["connect"])(function(e){var t,n=e[q],a=e.dictionary,i=e.loading,o=e.global,c=e.quickEntryParams;return t={},r()(t,q,n),r()(t,"dictionary",a),r()(t,"loading",i),r()(t,"global",o),r()(t,"quickEntryParams",c),t})(a["a"].create()(Y))}}]);