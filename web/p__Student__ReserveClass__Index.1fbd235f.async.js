(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[98],{VvUb:function(e,t,a){"use strict";a.r(t);a("y8nQ");var n=a("Vl3Y"),r=(a("7Kak"),a("9yH6")),c=(a("Pwec"),a("CtXQ")),o=(a("14J3"),a("BMrR")),s=(a("+L6B"),a("2/Rp")),i=(a("jCWc"),a("kPKH")),l=(a("T2oS"),a("W9HT")),u=(a("IzEo"),a("bx4M")),d=a("jehZ"),m=a.n(d),E=a("p0pE"),f=a.n(E),S=(a("miYZ"),a("tsqr")),C=(a("2qtc"),a("kLXV")),y=a("eHn4"),k=a.n(y),b=(a("/xke"),a("TeRw")),T=(a("+BJd"),a("mr32")),O=a("qIgq"),p=a.n(O),g=(a("5NDa"),a("5rEg")),N=a("q1tI"),I=a.n(N),v=a("MuoO"),_=a("v99g"),A=a("myFP"),R=a("mGJS"),h=a("9vKQ"),H=a("03Mi"),D=a("n7Ir"),M=a.n(D),G=a("wd/R"),j=a.n(G),U=(a("uY7g"),a("+kNj")),L=a("TSYQ"),w=a.n(L),K="reserveStudentList",x=function(e){e.dispatch;var t=e.visible,a=e.setVisible,n=e.form,r=e.params,c=function(e){e.preventDefault(),a(!1)},o=[{key:"key",title:"\u5e8f\u53f7"},h["a"].STUDENT.NAME,h["a"].STUDENT.MOBILE,h["a"].TEACHING.COURSE.CREATE_TIME,h["a"].STUDENT.CLASS_ID,h["a"].TEACHING.COURSE.LOGIC_STATUS,h["a"].TEACHING.COURSE.MEMO],s=[],i=Object(N["useMemo"])(function(){return s.map(function(e){return I.a.createElement(R["a"],m()({},e,{initialValue:e.initialValue,form:n}))})},[n]);return I.a.createElement(C["a"],{destroyOnClose:!0,title:r.title,width:"90%",visible:t,footer:null,onCancel:c,closable:!0,maskClosable:!0,keyboard:!1,bodyStyle:{padding:0}},I.a.createElement(_["a"],null,I.a.createElement(A["a"],m()({},e,{tableName:K,originColumns:o,formFields:i,tableSearchParams:{courseId:r.courseId},columnSortable:!1,scroll:{x:"max-content"}}))))},Y=Object(v["connect"])(function(e){var t,a=e[K],n=e.loading,r=e.global;return t={},k()(t,K,a),k()(t,"loading",n),k()(t,"global",r),t})(n["a"].create()(x)),V=U["a"].Description,B=g["a"].Search,P="reserve_1",q="reserve",F=0,z=function(e){var t=e.dispatch,a=e.form,n=e.loading,d=e.dictionary,E=e.reserve,y=(e.reserve_1,E.studentInfo),O=Object(N["useState"])(!1),g=p()(O,2),v=g[0],D=g[1],G=Object(N["useState"])(""),L=p()(G,2),K=L[0],x=L[1],z=Object(N["useState"])(!0),J=p()(z,2),Q=J[0],W=J[1],X=Object(N["useState"])(),Z=p()(X,2),$=Z[0],ee=Z[1],te=Object(N["useState"])(!1),ae=p()(te,2),ne=ae[0],re=ae[1],ce=Object(N["useState"])(!0),oe=p()(ce,2),se=oe[0],ie=oe[1],le=Object(N["useState"])("1"),ue=p()(le,2),de=ue[0],me=ue[1],Ee=Object(N["useState"])(0),fe=p()(Ee,2),Se=fe[0],Ce=fe[1],ye=Object(N["useState"])([]),ke=p()(ye,2),be=ke[0],Te=ke[1],Oe=Object(N["useState"])(!1),pe=p()(Oe,2),ge=pe[0],Ne=pe[1],Ie=Object(N["useState"])({}),ve=p()(Ie,2),_e=ve[0],Ae=ve[1];Object(N["useEffect"])(function(){["class_id","employee_id","employee_id_coach"].forEach(function(e){t({type:"dictionary/get",dictKey:e,dispatch:t})}),t({type:"reserve/queryStatusSetting"}),t({type:"reserve/clearStudentInfo"}),d.employee_id_coach&&Te(d["employee_id_coach"].filter(function(e){return 1*e.leaving!==2}))},[d]),Object(N["useEffect"])(function(){re(y.id&&4==y.studentStatus&&(1==y.km2Status||1==y.km3Status||2==y.km2Status||2==y.km3Status)),y.id?4!=y.studentStatus?ie(!1):1!=y.km2Status&&1!=y.km3Status&&2!=y.km2Status&&2!=y.km3Status?ie(!1):0==Object(H["b"])(d,"class_id",y.classId)("matchMode")?y.km2CoachId||y.km3CoachId?ie(!0):ie(!1):ie(!0):ie(!0)},[y]);var Re=Object(N["useMemo"])(function(){var e=Object(H["b"])(d,"class_id",y.classId);return I.a.createElement(U["a"],{className:M.a.description,size:"small",col:"3"},I.a.createElement(V,{term:"\u5b66\u5458\u59d3\u540d"},y.name),I.a.createElement(V,{term:"\u5b66\u5458\u6027\u522b"},Object(H["c"])(d,"gender",y.baseInfo.gender)),I.a.createElement(V,{term:"\u624b\u673a\u53f7"},y.mobile),I.a.createElement(V,{term:"\u7533\u9886\u7c7b\u578b"},Object(H["c"])(d,"license_type",y.licenseType)),I.a.createElement(V,{term:"\u5f53\u524d\u73ed\u578b"},Object(H["c"])(d,"class_id",y.classId)),I.a.createElement(V,{term:"\u5206\u914d\u6a21\u5f0f"},Object(H["c"])(d,"match_mode",e("matchMode"))||"\u65e0"),I.a.createElement(V,{term:"\u5f53\u524d\u72b6\u6001"},I.a.createElement(T["a"],{color:1==y.km2Status||2==y.km2Status?"blue":"red"},"\u79d1\u76ee\u4e8c\uff1a",y.km2Status?Object(H["c"])(d,"km_status",y.km2Status):"\u65e0"),I.a.createElement(T["a"],{color:1==y.km3Status||2==y.km3Status?"blue":"red"},"\u79d1\u76ee\u4e09\uff1a",y.km3Status?Object(H["c"])(d,"km_status",y.km3Status):"\u65e0")),I.a.createElement(V,{term:"\u5f53\u524d\u6559\u7ec3"},I.a.createElement(T["a"],{color:y.km2CoachId?"blue":"red"},"\u79d1\u76ee\u4e8c\uff1a",y.km2CoachId?Object(H["c"])(d,"employee_id",y.km2CoachId):"\u65e0"),I.a.createElement(T["a"],{color:y.km3CoachId?"blue":"red"},"\u79d1\u76ee\u4e09\uff1a",y.km3CoachId?Object(H["c"])(d,"employee_id",y.km3CoachId):"\u65e0")),I.a.createElement(V,{term:"\u5b66\u5458\u4e0a\u9650/\u8f66"},e("bookNum"),"\u4eba"),I.a.createElement(V,{term:"\u5141\u8bb8\u9884\u7ea6\u65e5"},Object(H["c"])(d,"week_day",e("allowDays"))),I.a.createElement(V,{term:"\u63d0\u524d\u9884\u7ea6"},e("preDays"),"\u5929"),I.a.createElement(V,{term:"\u5355\u65e5\u53ef\u7ea6\u6700\u591a\u8bfe\u8282"},e("lessonsPerDay"),"\u8282"),I.a.createElement(V,{term:"\u5b66\u5458\u72b6\u6001"},I.a.createElement(T["a"],{color:4==y.studentStatus?"blue":"red"},Object(H["c"])(d,"student_status",y.studentStatus)||"\u6682\u65e0")))},[y]),he=function(e){e&&(t({type:"".concat(q,"/search"),keywords:e}).then(function(t){!1!==t?D(!0):b["a"].error({message:"\u672a\u67e5\u8be2\u5230\u3010".concat(e,"\u3011\u5bf9\u5e94\u7684\u5b66\u5458\u4fe1\u606f\uff01")})}),me("1"))},He=n.effects["".concat(q,"/search")]||!1,De=function(e){t({type:"".concat(q,"/doOrderCourse"),params:k()({studentId:y.id,courseId:e.id},h["a"].TEACHING.COURSE.KM.key,$)}).then(function(t){!1!==t&&(F=0,je({studentId:y.id,courseId:e.id,batchNo:t}))})},Me=function(e){ne&&(["red","gray"].indexOf(qe(e))>=0||C["a"].confirm({title:"\u786e\u5b9a\u8981\u4e3a\u3010".concat(y.name,"\u3011\u9884\u7ea6\u3010").concat(e[h["a"].TEACHING.LESSON.COURSE_DATE.key]," ").concat(e[h["a"].TEACHING.LESSON.START_TIME.key],"-").concat(e[h["a"].TEACHING.LESSON.END_TIME.key],"\u3011\u3010").concat(Object(H["c"])(d,"employee_id",e[h["a"].TEACHING.LESSON.COACH_ID.key]),"\u3011\u3010").concat(Object(H["c"])(d,"coach_km",$)).concat(1==e.intensiveStatus?"\u96c6\u8bad":"","\u3011\u8fd9\u8282\u8bfe\u5417\uff1f"),okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){return De(e)}}))},Ge=function(e,t){Ae({courseId:e.id,title:[t,e.courseDate,e.startTime+"-"+e.endTime,Object(H["c"])(d,"coach_km",e.kmCode)].join("\uff0c")}),Ne(!0)},je=function e(a){++F<10?t({type:"".concat(q,"/queryOrderCourseResult"),params:a}).then(function(t){console.log(t),-112==t?setTimeout(function(){return e(a)},1e3):!1!==t&&D(!0)}):(F=0,b["a"].error({message:"\u672a\u67e5\u8be2\u5230\u9884\u7ea6\u7ed3\u679c\uff0c\u8bf7\u91cd\u65b0\u9884\u7ea6\uff01"}))},Ue=function(){t({type:"".concat(q,"/doIdentityInfo")}).then(function(e){!1!==e?(S["a"].success("\u8bfb\u53d6\u8eab\u4efd\u8bc1\u4fe1\u606f\u6210\u529f\uff01"),x(e.cardCode),he(e.cardCode)):b["a"].error({message:"\u8bfb\u53d6\u8eab\u4efd\u8bc1\u4fe1\u606f\u5931\u8d25\uff01"})})},Le=[];y.id&&1!=y.km2Status&&2!=y.km2Status||Le.push({dKey:"km2",dValue:"\u79d1\u76ee\u4e8c"}),y.id&&1!=y.km3Status&&2!=y.km3Status||Le.push({dKey:"km3",dValue:"\u79d1\u76ee\u4e09"});var we=Object(N["useMemo"])(function(){if(!y.id)return[{dKey:0,dValue:"\u6240\u6709\u6559\u7ec3\u8bfe\u7a0b"}];if("on"===E.status_setting.freedom)return y.km2CoachId||y.km3CoachId?[{dKey:1,dValue:"\u5f53\u524d\u6559\u7ec3\u8bfe\u7a0b"},{dKey:0,dValue:"\u5176\u4ed6\u6559\u7ec3\u8bfe\u7a0b"}]:[{dKey:0,dValue:"\u6240\u6709\u6559\u7ec3\u8bfe\u7a0b"}];var e=Object(H["b"])(d,"class_id",y.classId)("matchMode");return"freedom"===e?[{dKey:0,dValue:"\u6240\u6709\u6559\u7ec3\u8bfe\u7a0b"}]:[{dKey:1,dValue:"\u5f53\u524d\u6559\u7ec3\u8bfe\u7a0b"}]},[d.class_id,y.classId,E.status_setting.freedom]),Ke=[{config:f()({},h["a"].TEACHING.COURSE.TEACH_KM,{key:"teachKm"}),values:Le,initialValue:y.id&&Le[0]?Le[0].dKey:void 0,allowClear:!y.id},{config:h["a"].TEACHING.LESSON.CURRENT_COACH,values:we,initialValue:we[0].dKey,allowClear:!1},{config:h["a"].TEACHING.COURSE.COACH_ID,status:Q?"disabled":"edit",values:be},{config:h["a"].TEACHING.COURSE.SITE_ID},{config:h["a"].TEACHING.COURSE.DEPART_ID}],xe=[{config:f()({},h["a"].TEACHING.LESSON.COURSE_DATE,{props:{disabledDate:function(e){return e&&e<j()().startOf("day")}}}),col:8},{config:h["a"].TEACHING.COURSE.TEACH_KM,values:Le,initialValue:y.id&&Le[0]?Le[0].dKey:void 0,allowClear:!y.id},{config:{key:"courseArrange",title:"\u6392\u8bfe\u8bfe\u7a0b",type:"switch"},col:4},{config:h["a"].TEACHING.LESSON.START_TIME},{config:h["a"].TEACHING.LESSON.END_TIME},{config:h["a"].TEACHING.LESSON.CURRENT_COACH,values:we,initialValue:we[0].dKey,allowClear:!1},{config:h["a"].TEACHING.COURSE.COACH_ID,status:Q?"disabled":"edit"},{config:h["a"].TEACHING.COURSE.DEPART_ID}],Ye=function(e,t){switch(e){case"teachKm":case"kmCode":ee(t);break;case h["a"].TEACHING.LESSON.CURRENT_COACH.key:W(1==t);break}},Ve=Object(N["useMemo"])(function(){return Ke.map(function(e){return I.a.createElement(R["a"],m()({},e,{form:a,onChange:Ye}))})},[a,Q,Ke]),Be=Object(N["useMemo"])(function(){return xe.map(function(e){return I.a.createElement(R["a"],m()({},e,{form:a,onChange:Ye}))})},[a,Q,xe]),Pe=function(e){return Math.max.apply(Math,e.split(","))},qe=function(e){var t=parseInt(Pe(e.bookNum));if(e.placeNum>=t)return"red";if(y.id){var a=Object(H["b"])(d,"class_id",y.classId);if(j()(e.courseDate+" "+e.startTime).add(30,"m").isBefore(j()()))return"gray";if(1!=e.intensiveStatus){if(j()().isBefore(j()(e.courseDate+" 12:00:00").subtract(a("preDays"),"d")))return"gray";var n=Object(H["b"])(d,"week_day",a("allowDays"))("memo"),r=(j()(e.courseDate+" "+e.startTime).weekday()+1)%7;if(!n||n.indexOf(r)<0)return"gray";if(a("bookNum")>t)return"gray"}if("km2"===e.kmCode){if("km2"!==$)return"gray";if(2!=e.intensiveStatus&&2==y.km2Status!==(1==e.intensiveStatus))return"gray"}else if("km3"===e.kmCode){if("km3"!==$)return"gray";if(2!=e.intensiveStatus&&2==y.km3Status!==(1==e.intensiveStatus))return"gray"}else if("km2,km3"===e.kmCode){if("km2"===$&&1!=y.km2Status&&(2!=y.km2Status||2!=e.intensiveStatus))return"gray";if("km3"===$&&1!=y.km3Status&&(2!=y.km3Status||2!=e.intensiveStatus))return"gray"}if(!Le.find(function(t){return e.kmCode.indexOf(t.dKey)>=0}))return"gray"}return e.placeNum>0?"orange":"green"},Fe=[{key:"coachInfo",title:"\u6559\u7ec3\u4fe1\u606f",customRender:function(e,t){return I.a.createElement(N["Fragment"],null,I.a.createElement("div",{style:{width:"max-content"}},I.a.createElement(T["a"],{style:{fontSize:16,fontWeight:"bold"}},t.name),I.a.createElement(T["a"],null,t.mobile)),I.a.createElement("div",{style:{width:"max-content"}},I.a.createElement(T["a"],null,"\u7537"),I.a.createElement(T["a"],null,t.teachLicense),I.a.createElement(T["a"],null,Object(H["c"])(d,"coach_km",t.teachKm))),I.a.createElement("div",{style:{width:"max-content"}},I.a.createElement(T["a"],null,"\u4eba\u8f66\u4e0a\u9650\uff1a",t.bookNum)))}},{key:"reserveInfo",title:"\u7ea6\u8bfe\u65f6\u6bb5",customRender:function(e,t){return I.a.createElement(N["Fragment"],null,I.a.createElement(u["a"],{size:"small"},t.courses&&t.courses.map(function(e){return I.a.createElement(u["a"].Grid,{key:e.id,style:{position:"relative"},className:w()(M.a.calendarCard,M.a[qe(e)]),onClick:function(){return Me(e)}},I.a.createElement("div",{style:{fontWeight:"bold"}},e.startTime,"-",e.endTime),1*e.intensiveStatus===2&&I.a.createElement("span",{className:M.a.courseArrange},"\u6392"),I.a.createElement(T["a"],null,Object(H["c"])(d,"coach_km",e.kmCode),1==e.intensiveStatus?"\u96c6\u8bad":""),I.a.createElement("br",null),e.placeNum?I.a.createElement("a",{onClick:function(a){Ge(e,t.name),a.stopPropagation()}},I.a.createElement(T["a"],{className:M.a.aTag},e.placeNum,"/",Pe(e.bookNum))):I.a.createElement(T["a"],null,e.placeNum,"/",Pe(e.bookNum)))})))}}],ze=[{key:"key",title:"\u5e8f\u53f7"},h["a"].TEACHING.LESSON.COURSE_DATE,{key:"timeRange",title:"\u57f9\u8bad\u65f6\u6bb5",customRender:function(e,t){return[1*t.intensiveStatus===2?I.a.createElement(T["a"],{color:"#f50",key:"f50"},"\u6392"):"",t[h["a"].TEACHING.LESSON.START_TIME.key]+"-"+t[h["a"].TEACHING.LESSON.END_TIME.key]]}},h["a"].TEACHING.LESSON.COACH_ID,f()({},h["a"].TEACHING.LESSON.COACH_GENDER,{customRender:function(e,t){return Object(H["c"])(d,h["a"].EMPLOYEE.GENDER.key,Object(H["b"])(d,"employee_id",t[h["a"].TEACHING.LESSON.COACH_ID.key])(h["a"].EMPLOYEE.GENDER.key))}}),f()({},h["a"].TEACHING.LESSON.COACH_MOBILE,{customRender:function(e,t){return Object(H["c"])(d,h["a"].EMPLOYEE.MOBILE.key,Object(H["b"])(d,"employee_id",t[h["a"].TEACHING.LESSON.COACH_ID.key])(h["a"].EMPLOYEE.MOBILE.key))}}),f()({},h["a"].TEACHING.COURSE.TEACH_KM,{customRender:function(e,t){return Object(H["c"])(d,"coach_km",e)+(1==t.intensiveStatus?"\u96c6\u8bad":"")}}),{key:"studentNum",title:"\u9884\u7ea6\u4eba\u6570",customRender:function(e,t){return t.placeNum?I.a.createElement("a",{onClick:function(e){Ge(t,t.coachName),e.stopPropagation()}},t.studentNum,"/",Pe(t.bookNum)):I.a.createElement("div",null,t.studentNum,"/",Pe(t.bookNum))}},{key:"placeNum",title:"\u5360\u4f4d\u60c5\u51b5",customRender:function(e,t){return"".concat(t.placeNum,"/").concat(Pe(t.bookNum))}},h["a"].STUDENT.LICENSE_TYPE,{title:"\u64cd\u4f5c",key:"actions",customRender:function(e,t){return I.a.createElement(l["a"],{spinning:n.effects["".concat(q,"/queryOrderCourseResult")]||!1},I.a.createElement("a",{onClick:function(){return Me(t)}},"\u9884\u7ea6"))}}],Je=["\u672a\u7ea6","\u672a\u7ea6\u6ee1","\u5df2\u7ea6\u6ee1","\u4e0d\u53ef\u7ea6"];return I.a.createElement(_["a"],null,I.a.createElement(l["a"],{spinning:He},I.a.createElement(u["a"],{bordered:!1,style:{marginBottom:20}},I.a.createElement(o["a"],{gutter:24,type:"flex",justify:"center",style:{marginBottom:20}},I.a.createElement(i["a"],{md:10,sm:24},I.a.createElement(B,{size:"large",placeholder:"\u5b66\u5458\u624b\u673a\u53f7/\u8eab\u4efd\u8bc1\u53f7",value:K,onChange:function(e){return x(e.target.value)},onSearch:function(e){return he(e)},enterButton:!0})),I.a.createElement(i["a"],{md:6,sm:24},I.a.createElement(s["a"],{size:"large",type:"default",icon:"idcard",htmlType:"button",loading:n.effects["".concat(q,"/doIdentityInfo")],onClick:Ue},"\u8bfb\u53d6\u8eab\u4efd\u8bc1"))),y.id&&Re)),!He&&se&&I.a.createElement(N["Fragment"],null,I.a.createElement(u["a"],{bordered:!1,bodyStyle:{padding:"20px 24px 10px 24px"}},I.a.createElement(r["a"].Group,{defaultValue:de,size:"large",buttonStyle:"solid",onChange:function(e){return me(e.target.value)}},I.a.createElement(r["a"].Button,{value:"1"},I.a.createElement(c["a"],{type:"table"})," \u65e5\u5386\u5f62\u5f0f"),y.id&&I.a.createElement(r["a"].Button,{value:"2"},I.a.createElement(c["a"],{type:"unordered-list"})," \u5217\u8868\u5f62\u5f0f"))),1==de?I.a.createElement("div",{className:M.a.table_1},I.a.createElement(u["a"],{bordered:!1,bodyStyle:{padding:"10px 24px 10px 24px"}},I.a.createElement(o["a"],null,[0,1,2,3,4,5,6,7,8,9,10,11].map(function(e){return I.a.createElement(i["a"],{key:e,sm:2,className:w()(k()({},M.a.active,Se==e),M.a.date_ctnr),onClick:function(){return Ce(e)}},I.a.createElement("div",{className:M.a.date},j()().add(e,"days").format("DD")),I.a.createElement("div",{className:M.a.weekday},j()().add(e,"days").format("dddd")))}))),I.a.createElement(A["a"],m()({key:"table_1"},e,{tableSearchParams:{studentId:y.id,teachLicense:y.licenseType,bookNum:Object(H["b"])(d,"class_id",y.classId)("bookNum"),courseDate:j()().add(Se,"days").format("YYYY-MM-DD")},tableTags:Je,tableName:P,originColumns:Fe,formFields:Ve,columnSortable:!1,needUpdate:v,setNeedUpdate:D}))):I.a.createElement(A["a"],m()({key:"table_2"},e,{tableSearchParams:{studentId:y.id,isCurrentCoach:we[0].dKey},tableName:q,originColumns:ze,formFields:Be,columnSortable:!1,scroll:{x:"max-content"},needUpdate:v,setNeedUpdate:D}))),I.a.createElement(Y,{visible:ge,setVisible:Ne,params:_e,dispatch:t}))};t["default"]=Object(v["connect"])(function(e){var t,a=e[P],n=e[q],r=e.loading,c=e.dictionary,o=e.global;return t={},k()(t,P,a),k()(t,q,n),k()(t,"loading",r),k()(t,"dictionary",c),k()(t,"global",o),t})(n["a"].create()(z))},m74p:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),r=a.n(n),c=a("zHco"),o=a("Y2fQ"),s=a("MuoO"),i=a("usdK"),l=function(e){var t=e.match,a=e.children,n=e.location,s=(e.dispatch,e.reserve,e.loading,e.dictionary,[{priv:"order_course",key:"reserve",tab:"\u7ea6\u8bfe"},{priv:"order_course_record",key:"log",tab:"\u8bb0\u5f55"}]),l=function(e){i["a"].push("".concat(t.url,"/").concat(e))};return r.a.createElement(c["a"],{title:r.a.createElement(o["FormattedMessage"],{id:"menu.student.reserve-class"}),tabList:s,tabActiveKey:n.pathname.replace("".concat(t.path,"/"),""),onTabChange:l},a)};t["default"]=Object(s["connect"])(function(e){var t=e.loading,a=e.global,n=e.reserve,r=e.dictionary;return{loading:t,global:a,reserve:n,dictionary:r}})(l)},n7Ir:function(e,t,a){e.exports={description:"antd-pro-pages-student-reserve-class-reserve-description",courseArrange:"antd-pro-pages-student-reserve-class-reserve-courseArrange",table_1:"antd-pro-pages-student-reserve-class-reserve-table_1",date_ctnr:"antd-pro-pages-student-reserve-class-reserve-date_ctnr",active:"antd-pro-pages-student-reserve-class-reserve-active",date:"antd-pro-pages-student-reserve-class-reserve-date",calendarCard:"antd-pro-pages-student-reserve-class-reserve-calendarCard",green:"antd-pro-pages-student-reserve-class-reserve-green",gray:"antd-pro-pages-student-reserve-class-reserve-gray",orange:"antd-pro-pages-student-reserve-class-reserve-orange",red:"antd-pro-pages-student-reserve-class-reserve-red",white:"antd-pro-pages-student-reserve-class-reserve-white",aTag:"antd-pro-pages-student-reserve-class-reserve-aTag"}},ux9z:function(e,t,a){"use strict";a.r(t);a("y8nQ");var n=a("Vl3Y"),r=a("eHn4"),c=a.n(r),o=(a("2qtc"),a("kLXV")),s=(a("+L6B"),a("2/Rp")),i=(a("+BJd"),a("mr32")),l=a("jehZ"),u=a.n(l),d=a("p0pE"),m=a.n(d),E=a("qIgq"),f=a.n(E),S=a("q1tI"),C=a.n(S),y=a("MuoO"),k=a("v99g"),b=a("myFP"),T=a("mGJS"),O=a("9vKQ"),p=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),N=function(e){var t=e.selectedRow,a=e.onSubmit,r=e.visible,s=e.setVisible,i=e.form,l=e.loading,d=function(e){e.preventDefault(),i.validateFields(function(e,n){if(e)return!1;a(m()({},n,c()({id:t.id},O["a"].TEACHING.COURSE.RECORD_STATUS.key,9)))})},E=function(e){e.preventDefault(),s(!1)};return C.a.createElement(o["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u5907\u6ce8",width:350,visible:r,onOk:d,onCancel:E,closable:!0,maskClosable:!1,keyboard:!1,confirmLoading:l,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88"},C.a.createElement(n["a"],{onSubmit:d},C.a.createElement(p["a"],{gutter:24},[O["a"].TEACHING.COURSE.MEMO].map(function(a){return C.a.createElement(g["a"],{xs:24,md:24,key:a.key},C.a.createElement(T["a"],u()({},e,{config:a,form:i,initialValue:t[a.key],rules:[{required:!1,message:"\u8be5\u9879\u4e3a\u5fc5\u586b"}],style:{marginBottom:0}})))}))))},I=n["a"].create()(N),v=a("03Mi"),_=a("wd/R"),A=a.n(_),R=a("uY7g"),h="studentLogList",H=function(e){var t=e.dispatch,a=e.form,n=e.loading,r=(e.reserve,e.dictionary),c=Object(S["useState"])([]),l=f()(c,2),d=l[0],E=l[1],y=Object(S["useState"])(!1),p=f()(y,2),g=p[0],N=p[1],_=Object(S["useState"])({}),H=f()(_,2),D=H[0],M=H[1],G=Object(S["useState"])(!1),j=f()(G,2),U=j[0],L=j[1],w=function(e){return t({type:"".concat(h,"/updateCourseRecord"),params:e}).then(function(){L(!0)})},K=function(e){return t({type:"".concat(h,"/cancelCourseRecord"),params:e}).then(function(){L(!0)})},x=[{config:O["a"].TEACHING.COURSE.BOOK_DATE_RANGE,col:9,initialValue:[A()().subtract(1,"days"),A()().add(14,"days")]},{config:O["a"].TEACHING.COURSE.BOOK_TIME_RANGE,col:9},{config:O["a"].TEACHING.COURSE.LICENSE_TYPE_ACTIVE},{config:O["a"].TEACHING.COURSE.TEACH_KM,values:[{dKey:"km2",dValue:"\u79d1\u76ee\u4e8c"},{dKey:"km3",dValue:"\u79d1\u76ee\u4e09"}]},{config:O["a"].TEACHING.COURSE.LOGIC_STATUS},{config:O["a"].TEACHING.COURSE.SEARCH_COACH_ID},{config:O["a"].TEACHING.COURSE.QUICK_SEARCH2},{config:O["a"].TEACHING.COURSE.SITE_ID},{config:m()({},O["a"].TEACHING.COURSE.START_TIME,{title:"\u65f6\u6bb5\u7684\u5f00\u59cb\u65f6\u95f4"})},{config:m()({},O["a"].TEACHING.COURSE.END_TIME,{title:"\u65f6\u6bb5\u7684\u7ed3\u675f\u65f6\u95f4"})},{config:O["a"].TEACHING.COURSE.DEPART_ID},{config:O["a"].EMPLOYEE.COACH_INFO.COURSE_ARRANGE}],Y=Object(S["useMemo"])(function(){return x.map(function(e){return C.a.createElement(T["a"],u()({},e,{form:a}))})},[a]),V=function(){var e=a.getFieldsValue(),t=m()({},e);return e.bookDateRange&&(t.startDate=e.bookDateRange[0].format("YYYY-MM-DD"),t.endDate=e.bookDateRange[1].format("YYYY-MM-DD")),e.bookTimeRange&&(t.bookTimeBegin=e.bookTimeRange[0].format("YYYY-MM-DD"),t.bookTimeEnd=e.bookTimeRange[1].format("YYYY-MM-DD")),e.startTime&&(t.startTime=e.startTime.format("HH:mm:00")),e.endTime&&(t.endTime=e.endTime.format("HH:mm:00")),delete t.bookDateRange,delete t.bookTimeRange,t},B=function(){var e=V();t({type:"".concat(h,"/exportLog"),params:e}).then(function(e){window.open(e)})},P=function(e){return Math.max.apply(Math,e.split(","))},q=[{key:"key",title:"\u5e8f\u53f7"},O["a"].STUDENT.NAME,m()({},O["a"].STUDENT.MOBILE,{title:"\u5b66\u5458\u624b\u673a\u53f7"}),O["a"].TEACHING.LESSON.COURSE_DATE,{key:"timeRange",title:"\u57f9\u8bad\u65f6\u6bb5",customRender:function(e,t){return[1*t.intensiveStatus===2?C.a.createElement(i["a"],{color:"#f50"},"\u6392"):"",t[O["a"].TEACHING.LESSON.START_TIME.key]+"-"+t[O["a"].TEACHING.LESSON.END_TIME.key]]}},O["a"].TEACHING.LESSON.COACH_ID,O["a"].TEACHING.LESSON.COACH_MOBILE,O["a"].STUDENT.LICENSE_TYPE,m()({},O["a"].TEACHING.COURSE.KM,{customRender:function(e,t){return Object(v["c"])(r,O["a"].TEACHING.COURSE.KM.dictionary,t[O["a"].TEACHING.COURSE.KM.key])+(1==t.intensiveStatus?"\u96c6\u8bad":"")}}),{key:"studentNum",title:"\u9884\u7ea6\u4eba\u6570",customRender:function(e,t){return"".concat(t.studentNum,"/").concat(P(t.bookNum))}},{key:"bookTime",title:"\u9884\u7ea6\u65f6\u95f4",customRender:function(e,t){return t.createTime}},O["a"].TEACHING.COURSE.LOGIC_STATUS,O["a"].STUDENT.MEMO],F=[C.a.createElement(R["a"],{key:"complete_order_course",privs:["complete_order_course"]},C.a.createElement(s["a"],{key:"done-button",icon:"check",htmlType:"button",type:"primary",disabled:!(d.length&&("3"===d[0].logicStatus||"4"===d[0].logicStatus)),onClick:function(){M(d[0]),N(!0)}},"\u5b8c\u6210")),C.a.createElement(R["a"],{key:"cancel_order_course",privs:["cancel_order_course"]},C.a.createElement(s["a"],{key:"cancel-button",icon:"redo",htmlType:"button",type:"primary",disabled:!(d.length&&"0"===d[0].logicStatus),onClick:function(){o["a"].confirm({title:"\u786e\u5b9a\u8981\u64a4\u9500\u3010".concat(d[0][O["a"].STUDENT.NAME.key],"\u3011\u9884\u7ea6\u7684\u3010").concat(d[0][O["a"].TEACHING.LESSON.COURSE_DATE.key]," ").concat(d[0][O["a"].TEACHING.LESSON.START_TIME.key],"-").concat(d[0][O["a"].TEACHING.LESSON.END_TIME.key],"\u3011\u8fd9\u8282\u8bfe\u5417\uff1f"),okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){return K({id:d[0].id})}})}},"\u64a4\u9500")),C.a.createElement(s["a"],{key:"download",icon:"download",htmlType:"button",type:"primary",onClick:function(){return o["a"].confirm({title:"\u786e\u5b9a\u8981\u5bfc\u51fa\u6240\u7b5b\u9009\u51fa\u6765\u7684\u8bb0\u5f55\u5417\uff1f",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){B()}})}},"\u5bfc\u51fa")];return C.a.createElement(k["a"],null,C.a.createElement(b["a"],u()({},e,{tableName:h,originColumns:q,formFields:Y,tableActions:F,multipleSelection:!1,selectedRows:d,setSelectedRows:E,columnSortable:!1,scroll:{x:"max-content"},needUpdate:U,setNeedUpdate:L})),C.a.createElement(I,{selectedRow:D,visible:g,setVisible:N,loading:n.effects["".concat(h,"/saveLogMemo")],onSubmit:function(e){console.log(e),w(e).then(function(e){!1!==e&&N(!1)})}}))};t["default"]=Object(y["connect"])(function(e){var t,a=e[h],n=e.dictionary,r=e.loading,o=e.reserve,s=e.global;return t={},c()(t,h,a),c()(t,"dictionary",n),c()(t,"loading",r),c()(t,"reserve",o),c()(t,"global",s),t})(n["a"].create()(H))}}]);