(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{uLa3:function(e,a,t){"use strict";t.r(a);t("y8nQ");var n=t("Vl3Y"),r=t("eHn4"),i=t.n(r),c=(t("IzEo"),t("bx4M")),o=t("jehZ"),l=t.n(o),E=(t("T2oS"),t("W9HT")),S=(t("+L6B"),t("2/Rp")),s=t("qIgq"),u=t.n(s),T=t("p0pE"),A=t.n(T),m=t("q1tI"),d=t.n(m),f=t("6y2Z"),y=t("Zcyb"),p=t("MuoO"),b=t("myFP"),_=t("9vKQ"),k=t("mGJS"),C=t("zHco"),P=(t("2qtc"),t("kLXV")),O=(t("Pwec"),t("CtXQ")),I=(t("miYZ"),t("tsqr")),D=(t("DZo9"),t("8z0m")),g=t("Z2nI"),R=t("2ZYJ"),v=t("t3Un"),M=D["a"].Dragger,h=function(e){var a=e.visible,t=e.setVisible,n=e.loading,r=e.afterClose,i={name:"file",headers:Object(v["b"])(),action:"".concat(R["b"],"/api/assetmanage/import-cars"),onChange:function(e){var a=e.file.status;if("uploading"!==a&&console.log(e.file,e.fileList),"done"===a){var n=Object(g["a"])(e.file.response)("","");n.list&&n.list.length>0&&I["a"].success("".concat(Object.entries(n.list[n.list.length-1])[0][0],"\uff1a").concat(Object.entries(n.list[n.list.length-1])[0][1])),!1!==n&&t(!1)}else"error"===a&&I["a"].error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25\uff01."))}};return d.a.createElement(P["a"],{title:"\u8f66\u8f86\u6279\u91cf\u5bfc\u5165",visible:a,afterClose:r,closable:!0,maskClosable:!1,keyboard:!1,destroyOnClose:!0,okButtonProps:{loading:n},onCancel:function(){return t(!1)},footer:d.a.createElement(S["a"],{icon:"close-circle",htmlType:"button",onClick:function(){t(!1)}},"\u5173\u95ed")},d.a.createElement(M,i,d.a.createElement("p",{className:"ant-upload-drag-icon"},d.a.createElement(O["a"],{type:"inbox"})),d.a.createElement("p",{className:"ant-upload-text"},"\u5355\u51fb\u6216\u62d6\u52a8\u6587\u4ef6\u5230\u6b64\u533a\u57df\u8fdb\u884c\u4e0a\u4f20"),d.a.createElement("p",{className:"ant-upload-hint"},"\u8bf7\u4f7f\u7528\u6a21\u677f\u300a\u8f66\u8f86\u91c7\u8d2d.xlsx\u300b\u6765\u4e0a\u4f20\u3002")))},N=n["a"].create()(h),L=t("03Mi"),U=(t("14J3"),t("BMrR")),V=(t("jCWc"),t("kPKH")),Y=t("wd/R"),j=t.n(Y),w=function(e){var a=e.handleSubmit,t=e.visible,r=e.setVisible,c=e.form,o=e.data,l=void 0===o?{}:o,E=e.loading,S=e.afterClose;l[_["a"].ASSET.DEPART_ID.key]&&(l[_["a"].ASSET.DEPART_ID.key]=String(l[_["a"].ASSET.DEPART_ID.key])),l[_["a"].ASSET.SITE_ID.key]&&(l[_["a"].ASSET.SITE_ID.key]=String(l[_["a"].ASSET.SITE_ID.key])),l[_["a"].ASSET.EMPLOYEE_ID.key]&&(l[_["a"].ASSET.EMPLOYEE_ID.key]=String(l[_["a"].ASSET.EMPLOYEE_ID.key])),l[_["a"].ASSET.PURCHASE_DATE.key]||(l[_["a"].ASSET.PURCHASE_DATE.key]=null);var s=Object(f["a"])(!1),T=u()(s,2),m=T[0],y=T[1],p=function(e,a){switch(e){case _["a"].ASSET.PURPOSE.key:y("teaching"===a||"exam"===a);break}},b=[_["a"].ASSET.PLATE_NO,A()({},_["a"].ASSET.PURPOSE,{defaultValue:"teaching"}),A()({},_["a"].ASSET.LICENSE_TYPE_ACTIVE,{rules:[{required:m}]}),_["a"].ASSET.BRAND,_["a"].ASSET.MODEL,_["a"].ASSET.COLOR,_["a"].ASSET.ENGINE_NO,_["a"].ASSET.VIN,_["a"].ASSET.MANUFACTURE,_["a"].ASSET.PURCHASE_TYPE,_["a"].ASSET.PURCHASE_DATE,A()({},_["a"].ASSET.PURCHASE_AMOUNT,{type:"inputNumber",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},min:0}),_["a"].ASSET.DEPART_ID,_["a"].ASSET.SITE_ID_ACTIVE,A()({},_["a"].ASSET.CAR_STATUS,{defaultValue:"normal",col:24})],C=function(e){e.preventDefault(),c.validateFields(function(e,t){var n;if(e)return!1;a(A()({},t,(n={},i()(n,_["a"].ASSET.PURCHASE_DATE.key,j()().format("YYYY-MM-DD")),i()(n,"id",l.id),n)))})};return d.a.createElement(P["a"],{title:l.id?"\u7f16\u8f91\u8f66\u8f86":"\u65b0\u589e\u8f66\u8f86",width:"90%",visible:t,afterClose:S,onOk:C,closable:!0,maskClosable:!1,keyboard:!1,destroyOnClose:!0,confirmLoading:E,onCancel:function(){return r(!1)}},d.a.createElement(n["a"],{onSubmit:C},d.a.createElement(U["a"],{gutter:{xs:8,sm:16,md:20}},b.map(function(e){return d.a.createElement(V["a"],{key:e.key,md:e.col||6,sm:24},d.a.createElement(k["a"],{config:e,formatter:e.formatter,parser:e.parser,min:e.min,values:e.values,onChange:p,rules:e.rules||[{required:!0}],initialValue:l[e.key],defaultValue:e.defaultValue,form:c}))}),d.a.createElement(V["a"],{key:_["a"].ASSET.EMPLOYEE_ID.key,sm:24},d.a.createElement(k["a"],{config:_["a"].ASSET.EMPLOYEE_ID,initialValue:l[_["a"].ASSET.EMPLOYEE_ID.key],form:c})),d.a.createElement(V["a"],{key:_["a"].ASSET.MEMO.key,sm:24},d.a.createElement(k["a"],{config:_["a"].ASSET.MEMO,rules:[],initialValue:l[_["a"].ASSET.MEMO.key],form:c})))))},H=n["a"].create()(w),q=(t("bP8k"),t("gFTJ")),x=t("QL5A"),B=q["a"].Item,Z=[_["a"].ASSET.PLATE_NO,_["a"].ASSET.PURPOSE,_["a"].ASSET.LICENSE_TYPE,_["a"].ASSET.BRAND,_["a"].ASSET.MODEL,_["a"].ASSET.COLOR,_["a"].ASSET.ENGINE_NO,_["a"].ASSET.VIN,_["a"].ASSET.MANUFACTURE,_["a"].ASSET.PURCHASE_TYPE,_["a"].ASSET.PURCHASE_DATE,_["a"].ASSET.PURCHASE_AMOUNT,_["a"].ASSET.DEPART_ID,_["a"].ASSET.SITE_ID,_["a"].ASSET.CAR_STATUS,_["a"].ASSET.MEMO],F=function(e){var a=e.data,t=void 0===a?{}:a,n=e.visible,r=e.setVisible,i=e.dictionary,c=Object(x["a"])(i)(t);return d.a.createElement(P["a"],{title:"\u8f66\u8f86\u4fe1\u606f",width:"90%",visible:n,destroyOnClose:!0,onCancel:function(){return r(!1)},closable:!0,maskClosable:!1,keyboard:!1,footer:d.a.createElement(S["a"],{icon:"close-circle",htmlType:"button",onClick:function(){r(!1)}},"\u5173\u95ed")},d.a.createElement(q["a"],{bordered:!0},Z.map(function(e){return d.a.createElement(B,{key:e.key,label:e.title},c(e)||"\u6682\u65e0")})))},J=n["a"].create()(F),z=t("usdK"),Q=t("uY7g"),G="assetCarList",K=[_["a"].ASSET.PURPOSE,_["a"].ASSET.LICENSE_TYPE_ACTIVE,_["a"].ASSET.SITE_ID_ACTIVE,_["a"].ASSET.DEPART_ID,A()({},_["a"].ASSET.CAR_STATUS,{type:"select"}),_["a"].ASSET.PLATE_NO,_["a"].ASSET.COACH_ID],W=function(e){var a=e.form,t=e.dispatch,n=e.loading,r=e.dictionary,i=e.quickEntryParams,o=Object(f["a"])(!1),s=u()(o,2),T=s[0],p=s[1],P=Object(f["a"])(!1),O=u()(P,2),I=O[0],D=O[1],g=Object(f["a"])(!1),R=u()(g,2),v=R[0],M=R[1],h=Object(m["useState"])({}),U=u()(h,2),V=U[0],Y=U[1],j=Object(m["useState"])(void 0),w=u()(j,2),q=w[0],x=w[1];Object(y["a"])(function(){"record"===i?(Y({}),D(!0)):"import"===i&&p(!0),t({type:"quickEntryParams/clearParams"})});var B=n.effects["".concat(G,"/getCarInfo")]||!1,Z=function(e){return function(a){x(e),t({type:"".concat(G,"/getCarInfo"),payload:e}).then(function(e){Y(e),a&&a()})}},F=[d.a.createElement(Q["a"],{privs:["car_add"],key:"car_add"},d.a.createElement(S["a"],{key:"plus-button",icon:"edit",htmlType:"button",type:"primary",onClick:function(){Y({}),D(!0)}},"\u5f55\u5165\u8f66\u8f86\u4fe1\u606f")),d.a.createElement(Q["a"],{privs:["car_import"],key:"car_import"},d.a.createElement(S["a"],{key:"upload-button",icon:"upload",htmlType:"button",type:"primary",onClick:function(){p(!0)}},"\u5bfc\u5165\u8f66\u8f86\u4fe1\u606f")),d.a.createElement(Q["a"],{privs:["download_car_templete"],key:"download_car_templete"},d.a.createElement(S["a"],{key:"download",icon:"download",htmlType:"button",type:"default",onClick:function(){return z["a"].push("/user-center/template-download")}},"\u4e0b\u8f7d\u5bfc\u5165\u6a21\u677f"))],W=[{title:"\u5e8f\u53f7",key:"key"},A()({},_["a"].ASSET.PLATE_NO,{customRender:function(e,a){return d.a.createElement(Q["a"],{privs:["car_detail"],noMatch:e},d.a.createElement("a",{onClick:function(e){e.stopPropagation(),B||Z(a.id)(function(){return M(!0)})}},q===a.id&&B&&d.a.createElement(E["a"],{size:"small"})," ",e))}}),_["a"].ASSET.BRAND,_["a"].ASSET.MODEL,_["a"].ASSET.PURPOSE,_["a"].ASSET.LICENSE_TYPE,_["a"].ASSET.SITE_ID,_["a"].ASSET.DEPART_ID,_["a"].ASSET.CAR_STATUS,_["a"].ASSET.EMPLOYEE_ID,{title:"\u64cd\u4f5c",key:"action",customRender:function(e,a){return d.a.createElement(Q["a"],{privs:["car_edit"],noMatch:"\u7f16\u8f91"},d.a.createElement("a",{onClick:function(e){e.stopPropagation(),B||Z(a.id)(function(){return D(!0)})}},q===a.id&&B&&d.a.createElement(E["a"],{size:"small"})," \u7f16\u8f91"))}}],X=Object(m["useMemo"])(function(){return K.map(function(e){return d.a.createElement(k["a"],{config:e,form:a})})},[a]);return d.a.createElement(C["a"],{title:"\u8f66\u8f86\u7ba1\u7406"},d.a.createElement(c["a"],null,d.a.createElement(b["a"],l()({},e,{bodyStyle:{padding:0},tableName:G,tableActions:F,originColumns:W,scroll:{x:"max-content"},formFields:X})),d.a.createElement(N,{afterClose:function(){t({type:"".concat(G,"/refresh")})},data:V,visible:T,setVisible:p}),d.a.createElement(H,{afterClose:function(){t({type:"".concat(G,"/refresh")})},data:V,handleSubmit:function(e){t({type:"".concat(G,"/saveCar"),payload:A()({},e)}).then(function(e){!1!==e&&(Object(L["e"])(t,"car_id"),D(!1))})},dictionary:r,visible:I,setVisible:D}),d.a.createElement(J,{data:V,dictionary:r,visible:v,setVisible:M})))};a["default"]=Object(p["connect"])(function(e){var a,t=e[G],n=e.loading,r=e.global,c=e.signUp,o=e.dictionary,l=e.quickEntryParams;return a={},i()(a,G,t),i()(a,"loading",n),i()(a,"global",r),i()(a,"signUp",c),i()(a,"dictionary",o),i()(a,"quickEntryParams",l),a})(n["a"].create()(W))}}]);